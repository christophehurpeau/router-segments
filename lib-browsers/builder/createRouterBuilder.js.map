{"version":3,"sources":["../../src/builder/createRouterBuilder.js"],"names":["locales","defaultLocale","routes","routeMap","Map","addToRouteMap","key","route","has","Error","set","createSegmentRouterBuilder","add","path","ref","push","addLocalized","localizedPaths","finalKey","addSegment","buildSegment","freeze","addLocalizedSegment","getRoutes","createRouter"],"mappings":";;;;;;AAUA;;AAMA;;;;AACA;;;;;;kBAEe,UAACA,OAAD,EAA8C;AAC3D,MAAMC,gBAAgBD,WAAWA,QAAQ,CAAR,CAAjC;AACA,MAAME,WAAN;AACA,MAAMC,WAAyB,IAAIC,GAAJ,EAA/B;;AAEA,MAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,GAAD,EAAcC,KAAd,EAAmC;AACvD,QAAIJ,SAASK,GAAT,CAAaF,GAAb,CAAJ,EAAuB,MAAM,IAAIG,KAAJ,OAAcH,GAAd,uBAAN;AACvBH,aAASO,GAAT,CAAaJ,GAAb,EAAkBC,KAAlB;AACD,GAHD;;AAKA,MAAMI,6BAA6B,iDACjCV,aADiC,EAEjCI,aAFiC,CAAnC;;AAKA,SAAO;AACLO,SAAK,aAACC,IAAD,EAAeC,GAAf,EAAkCR,GAAlC,EAAyD;AAC5D,UAAMC,QAAQ,yBAAYM,IAAZ,EAAkBA,IAAlB,EAAwBC,GAAxB,CAAd;AACAZ,aAAOa,IAAP,CAAYR,KAAZ;AACA,UAAI,CAACD,GAAL,EAAUA,MAAMO,IAAN;AACVR,oBAAcC,GAAd,EAAmBC,KAAnB;AACD,KANI;;AAQLS,kBAAc,sBAACC,cAAD,EAAqCH,GAArC,EAAwDR,GAAxD,EAA+E;AAC3F,UAAI,CAACL,aAAL,EAAoB,MAAM,IAAIQ,KAAJ,CAAU,iBAAV,CAAN;AACpB,UAAMF,QAAQ,kCAAqBU,cAArB,EAAqCA,cAArC,EAAqDH,GAArD,CAAd;AACAZ,aAAOa,IAAP,CAAYR,KAAZ;AACA,UAAMW,WAAmBZ,OAAOW,eAAehB,aAAf,CAAhC;AACAI,oBAAca,QAAd,EAAwBX,KAAxB;AACD,KAdI;;AAgBLY,gBAAY,oBAACN,IAAD,EAAeO,YAAf,EAAmF;AAC7F,UAAMb,QAAQ,gCAAmBM,IAAnB,EAAyBA,IAAzB,CAAd;AACAO,mBAAaT,2BAA2BJ,KAA3B,CAAb;AACAA,YAAMc,MAAN;AACAnB,aAAOa,IAAP,CAAYR,KAAZ;AACD,KArBI;;AAuBLe,yBAAqB,6BACnBL,cADmB,EAEnBG,YAFmB,EAGV;AACT,UAAI,CAACnB,aAAL,EAAoB,MAAM,IAAIQ,KAAJ,CAAU,iBAAV,CAAN;AACpB,UAAMF,QAAQ,yCAA4BU,cAA5B,EAA4CA,cAA5C,CAAd;AACAG,mBAAaT,2BAA2BJ,KAA3B,CAAb;AACAA,YAAMc,MAAN;AACAnB,aAAOa,IAAP,CAAYR,KAAZ;AACD,KAhCI;;AAkCLgB,eAAW;AAAA,aAAMrB,MAAN;AAAA,KAlCN;AAmCLsB,kBAAc;AAAA,aAAM,4BAAatB,MAAb,EAAqBC,QAArB,CAAN;AAAA;AAnCT,GAAP;AAqCD,C","file":"createRouterBuilder.js","sourcesContent":["import type {\n  LocalesType,\n  RouterBuilderType,\n  PathDictionaryType,\n  RoutesType,\n  RouteMapType,\n  RouteType,\n  SegmentRouterBuilderType,\n  RouteRefType,\n} from '../types';\nimport {\n  createRoute,\n  createLocalizedRoute,\n  createSegmentRoute,\n  createLocalizedSegmentRoute,\n} from '../routes/create';\nimport createRouter from '../router/createRouter';\nimport createSegmentRouterBuilderCreator from './createSegmentRouterBuilderCreator';\n\nexport default (locales: ?LocalesType): RouterBuilderType => {\n  const defaultLocale = locales && locales[0];\n  const routes: RoutesType = [];\n  const routeMap: RouteMapType = new Map();\n\n  const addToRouteMap = (key: string, route: RouteType) => {\n    if (routeMap.has(key)) throw new Error(`\"${key}\" is already used`);\n    routeMap.set(key, route);\n  };\n\n  const createSegmentRouterBuilder = createSegmentRouterBuilderCreator(\n    defaultLocale,\n    addToRouteMap,\n  );\n\n  return {\n    add: (path: string, ref: RouteRefType, key: ?string): void => {\n      const route = createRoute(path, path, ref);\n      routes.push(route);\n      if (!key) key = path;\n      addToRouteMap(key, route);\n    },\n\n    addLocalized: (localizedPaths: PathDictionaryType, ref: RouteRefType, key: ?string): void => {\n      if (!defaultLocale) throw new Error('Invalid locales');\n      const route = createLocalizedRoute(localizedPaths, localizedPaths, ref);\n      routes.push(route);\n      const finalKey: string = key || localizedPaths[defaultLocale];\n      addToRouteMap(finalKey, route);\n    },\n\n    addSegment: (path: string, buildSegment: (builder: SegmentRouterBuilderType) => void): void => {\n      const route = createSegmentRoute(path, path);\n      buildSegment(createSegmentRouterBuilder(route));\n      route.freeze();\n      routes.push(route);\n    },\n\n    addLocalizedSegment: (\n      localizedPaths: PathDictionaryType,\n      buildSegment: (builder: SegmentRouterBuilderType) => void,\n    ): void => {\n      if (!defaultLocale) throw new Error('Invalid locales');\n      const route = createLocalizedSegmentRoute(localizedPaths, localizedPaths);\n      buildSegment(createSegmentRouterBuilder(route));\n      route.freeze();\n      routes.push(route);\n    },\n\n    getRoutes: () => routes,\n    createRouter: () => createRouter(routes, routeMap),\n  };\n};\n"]}