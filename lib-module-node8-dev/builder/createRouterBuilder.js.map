{"version":3,"sources":["../../src/builder/createRouterBuilder.js"],"names":["LocalesType","RouterBuilderType","PathDictionaryType","RoutesType","RouteMapType","RouteType","SegmentRouterBuilderType","RouteRefType","createRoute","createLocalizedRoute","createSegmentRoute","createLocalizedSegmentRoute","createRouter","createSegmentRouterBuilderCreator","locales","defaultLocale","Map","addToRouteMap","key","route","routeMap","has","Error","set","createSegmentRouterBuilder","add","path","ref","routes","push","addLocalized","localizedPaths","localizedPath","finalKey","addSegment","buildSegment","freeze","addLocalizedSegment","getRoutes"],"mappings":"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","file":"createRouterBuilder.js","sourcesContent":["import type {\n  LocalesType,\n  RouterBuilderType,\n  PathDictionaryType,\n  RoutesType,\n  RouteMapType,\n  RouteType,\n  SegmentRouterBuilderType,\n  RouteRefType,\n} from '../types';\nimport {\n  createRoute,\n  createLocalizedRoute,\n  createSegmentRoute,\n  createLocalizedSegmentRoute,\n} from '../routes/create';\nimport createRouter from '../router/createRouter';\nimport createSegmentRouterBuilderCreator from './createSegmentRouterBuilderCreator';\n\nexport default (locales: ?LocalesType): RouterBuilderType => {\n  const defaultLocale = locales && locales[0];\n  const routes: RoutesType = [];\n  const routeMap: RouteMapType = new Map();\n\n  const addToRouteMap = (key: string, route: RouteType) => {\n    if (routeMap.has(key)) throw new Error(`\"${key}\" is already used`);\n    routeMap.set(key, route);\n  };\n\n  const createSegmentRouterBuilder = createSegmentRouterBuilderCreator(\n    defaultLocale,\n    addToRouteMap,\n  );\n\n  return {\n    add: (path: string, ref: RouteRefType, key: ?string): void => {\n      const route = createRoute(path, path, ref);\n      routes.push(route);\n      if (!key) key = path;\n      addToRouteMap(key, route);\n    },\n\n    addLocalized: (localizedPaths: PathDictionaryType, ref: RouteRefType, key: ?string): void => {\n      if (!defaultLocale) throw new Error('Invalid locales');\n      const route = createLocalizedRoute(localizedPath, localizedPath, ref);\n      routes.push(route);\n      const finalKey: string = key || localizedPath[defaultLocale];\n      addToRouteMap(finalKey, route);\n    },\n\n    addSegment: (path: string, buildSegment: SegmentRouterBuilderType): void => {\n      const route = createSegmentRoute(path, path);\n      buildSegment(createSegmentRouterBuilder(route));\n      route.freeze();\n      routes.push(route);\n    },\n\n    addLocalizedSegment: (\n      localizedPaths: PathDictionaryType,\n      buildSegment: SegmentRouterBuilderType,\n    ): void => {\n      if (!defaultLocale) throw new Error('Invalid locales');\n      const route = createLocalizedSegmentRoute(localizedPaths, localizedPaths);\n      buildSegment(createSegmentRouterBuilder(route));\n      route.freeze();\n      routes.push(route);\n    },\n\n    getRoutes: () => routes,\n    createRouter: () => createRouter(routes, routeMap),\n  };\n};\n"]}